/*
 ╔═══════════════════════════════════════════════════════════════════════════╗
 ║                     (c) 1994,97 корпорация ГАЛАКТИКА                      ║
 ║ Проект        : ГАЛАКТИКА                                                 ║
 ║ Система       : Заработная плата                                          ║
 ║ Версия        : 5.50                                                      ║
 ║ Ответственный : Лисица Наталья Михайловна                                 ║
 ║ Назначение    : Ведомости по нарядам                                      ║
 ║                                                                           ║
 ║ Изменения                                                                 ║
 ║     Автор: Корзюк В.Ф.         Дата: 13.10.98                             ║
 ║     Цель : Добавлена (а кое где и использована) возможность разрыва       ║
 ║            страницы между печатаемыми документами (событие PageBreak).    ║
 ║                                                                           ║
 ║     Автор: ___________________ Дата: __________________                   ║
 ║     Цель : ____________________________________________                   ║
 ╚═══════════════════════════════════════════════════════════════════════════╝
*/

#doc
Ведомости по нарядам
#end
.form VedNar
.uniqueconsts
.hide
.p 60
.fields
  Npred
  dat1
  DepartmentName
  BrigadeName
  JobSheetName
  SYS_NAR_NREC
  SalaryAlgorithm
  PremiumAlgorithm

!Лицевая сторона
  KodVidOplNar
  NaimVidOplNar
  ProcDopNar
  SummaDopNar
  SchetDebDopNar
  SubSchdebDopNar
  NamKAUDDopNar

  LshKodWork
  NmWork
  LshKodOper
  NmOper
  KolVoEdin
  LshRascen
  LshNormaTime
  StoimWork
  SummaTime
!доплаты
  KodVidOpl
  NaimVidOpl
  ProcDop
  SummaDop
  SchetDebDop
  SubSchdebDop
  NamKAUDDop
  JobListAddPayHours
  JobListAddPayDays
!итоги по лицевой стороне
  SummaStoimLsh: double
  SummamTimeLsh: double
  SummaDopLsh: double
  SummaDopLshN: double

!Строки
  NP
  TABN
  FIO
  PersonalAccountDepartmentName

  PRNARYAD_NREC
  prof
  razr
  tarif
  tarkof
  KTY
  CostsAssignmentDepartmentName
  cPodr
  cPodrOZ
  VIDOPL
  Vidprem
  MES
  Datan
  DatOk
  KOLDN: double
  CHASF: double
  KOLDNGR: double
  CHASGR: double
  SISOPL
  tartime: double
  SUMMATR: double
  SUMMA: double
  SUMMAPR: double
  proc
  SUMMPREM: double
  KODWork
  NOPER
  RASCEN: double
  KolVo
  NRMTIME
  SchetDeb
  SubSchdeb
  NamKAUD

!доплаты на работу
  NarDopName: string
  NarDopVidOpl: word
  NarDopHours: double
  NarDopDays: double
  NarDopProc: double
  NarDopSum: double
  NarDopSchet: string
  NarDopSubSch: string
  NarDopNamKau: string
.endfields
^ ^
.{ DepartmentLoop checkenter
^
.{ BrigadeLoop checkenter
^
.{ JobSheetLoop checkenter
^ ^ ^ ^
.{ JobSheetAdditionalPaymentLoop checkenter
^ ^ ^ ^ ^ ^ ^
.}
! лицевая сторона наряда
.{ JobListLoop  checkenter
 ^ ^ ^ ^ ^ ^ ^ ^ ^
.{ JobListItemAdditionalPaymentLoop  checkenter
 ^ ^ ^ ^ ^ ^ ^ ^ ^
.}
.}
^ ^ ^ ^
! спецификация наряда
.{ JobLoop checkenter
^ ^ ^ ^
.{ PersonalAccountLoop checkenter
^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^
^ ^ ^ ^ ^ ^ ^ ^
^ ^ ^ ^ ^ ^ ^ ^
.{ JobAdditionalPaymentLoop checkenter
^
^
^
^
^
^
^
^
^
.}
.}
.}
.}
.}
.}
.endform

!-------------------------------------------------------------------------------
.linkform 'VedNar_01' prototype is 'vednar'
.NameInList  'Табель - расчет '
.group 'Зарплата с учетом КТУ'
!.p 10
.var
  PersonalAccountCount: longint;
  sum_KOLDN   : double;
  sum_CHASF   : double;
  sum_SUMMATR : double;
  sum_SUMMA   : double;
  sum_SUMMPREM: double;
  sum_AGRSUM  : double;

.endvar
.fields
  CommonFormHeader
  Npred
  dat1
  JobSheetName

  if (PersonalAccountCount > 0, '', TABN)
  if (PersonalAccountCount > 0, '', FIO)
  prof razr tarif  tarkof KTY
  KOLDN CHASF tartime   SUMMATR SUMMA  SUMMPREM SUMMA + SUMMPREM

  sum_KOLDN
  sum_CHASF
  sum_SUMMATR
  sum_SUMMA
  sum_SUMMPREM
  sum_AGRSUM

  KOLDN:'sum:Vednar_PersonalAccountLoop'
  CHASF:'sum:Vednar_PersonalAccountLoop'
  SUMMATR:'sum:Vednar_PersonalAccountLoop'
  SUMMA:'sum:Vednar_PersonalAccountLoop'
  SUMMPREM:'sum:Vednar_PersonalAccountLoop'
  (SUMMA + SUMMPREM):'sum:Vednar_PersonalAccountLoop'
 'true':'s'
.endfields
 И^
┌────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┐
│                           @~@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@                                                                                               │
│                                           ТАБЕЛЬ - РАСЧЕТ                                                                                                                      │
│                                        @~@@@@@@@@@@@@@@@@@@@@                                                                                                                  │
.{ Vednar_DepartmentLoop checkenter
.{ VedNar_BrigadeLoop checkenter
.{ VedNar_JobSheetLoop checkenter
┌────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┐
│                                                                                                                                                                                │
│                                         @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@                                                                                                       │
.{ Vednar_JobSheetAdditionalPaymentLoop  checkenter
.}
.{ Vednar_JobListLoop  checkenter
.{ Vednar_JobListItemAdditionalPaymentLoop checkenter
.}
.}
├──────────┬──────────────────────────┬────────────────────┬────┬───────────┬────────┬────────┬────────────────────┬────────┬─────────────┬────────────┬────────────┬────────────│
│ ТАБЕЛЬНЫЙ│      ФАМИЛИЯ ИМЯ         │    ПРОФЕССИЯ       │РАЗ-│   ТАРИФ   │ТАРИФНЫЙ│  КТУ   │    ОТРАБОТАНО      │РАСЧЕТН.│ З/ПЛ. ПО    │  СДЕЛЬНАЯ  │ ПРЕМИЯ     │ИТОГО       │
│   НОМЕР  │       ОТЧЕСТВО           │                    │РЯД │           │ КОЭФ-Т │        │  ДНЕЙ    │  ЧАCOB  │ КОЭФ-Т │ТАРИФУ С КТУ │  З/ПЛ.     │            │            │
└──────────┴──────────────────────────┴────────────────────┴────┴───────────┴────────┴────────┴──────────┴─────────┴────────┴─────────────┴────────────┴────────────┴────────────┘
.{ Vednar_JobLoop checkenter
.begin PersonalAccountCount := 0
  sum_KOLDN   := 0;
  sum_CHASF   := 0;
  sum_SUMMATR := 0;
  sum_SUMMA   := 0;
  sum_SUMMPREM:= 0;
  sum_AGRSUM  := 0;
end.
.{ VedNar_PersonalAccountLoop checkenter
│@@@@@@@@@@│@@@@@@@@@@@@@@@@@@@@@@@@@@│@@@@@@@@@@@@@@@@@@@@│&'&&│&'&&&&&.&&&│&'&&&.&&│&'&&&.&&│&'&&&&.&& │&'&&&&.&&│&'&&&.&&│&'&&&&&&&&.&&│&'&&&&&&&.&&│&'&&&&&&&.&&│&'&&&&&&&.&&
.begin Inc(PersonalAccountCount)
  sum_KOLDN   := sum_KOLDN+ KOLDN;
  sum_CHASF   := sum_CHASF+ CHASF;
  sum_SUMMATR := sum_SUMMATR+ SUMMATR;
  sum_SUMMA   := sum_SUMMA+ SUMMA;
  sum_SUMMPREM:= sum_SUMMPREM+ SUMMPREM;
  sum_AGRSUM  := sum_AGRSUM+ SUMMA+ SUMMPREM+ NARDOPSUM;
end.
.{ Vednar_JobAdditionalPaymentLoop checkenter
.}
.}
.{?internal;PersonalAccountCount > 1
 Б│          │                          │                    │    │           │        │   ИТОГО│&'&&&&.&& │&'&&&&.&&│        │&'&&&&&&&&.&&│&'&&&&&&&.&&│&'&&&&&&&.&&│&'&&&&&&&.&& Б
.}
══════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
 Б   ИТОГО ПО НАРЯДУ                                         │    │           │        │        │&'&&&&.&& │&'&&&&.&&│        │&'&&&&&&&&.&&│&'&&&&&&&.&&│&'&&&&&&&.&&│&'&&&&&&&.&& Б
══════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════ И
.}
 ^
.}
.}
.}
.endform

!-------------------------------------------------------------------------------
.linkform 'VedNar_02' prototype is 'vednar'
.NameInList  'Справка о бригадных нарядах'
.group 'Бригадные наряды'
.p 60
.var
  PersonalAccountCount: longint
  sum_KOLDN   : double;
  sum_CHASF   : double;
  sum_SUMMA   : double;
  sum_SUMMPREM: double;

.endvar
.fields
 CommonFormHeader
 Npred dat1
 JobSheetName

  if (PersonalAccountCount > 0, '', NP)
  if (PersonalAccountCount > 0, '', PersonalAccountDepartmentName)
  if (PersonalAccountCount > 0, '', TABN)
  if (PersonalAccountCount > 0, '', FIO)
  tarif KTY  KOLDN CHASF SUMMA  SUMMPREM

  sum_KOLDN
  sum_CHASF
  sum_SUMMA
  sum_SUMMPREM

  KOLDN:'sum:Vednar_PersonalAccountLoop'
  CHASF:'sum:Vednar_PersonalAccountLoop'
  SUMMA:'sum:Vednar_PersonalAccountLoop'
  SUMMPREM:'sum:Vednar_PersonalAccountLoop'
.endfields
 Р^
.{ VedNar_DepartmentLoop checkenter
.{ VedNar_BrigadeLoop checkenter
.{ Vednar_JobSheetLoop checkenter


                          С П Р А В К А  О  Н А Р Я Д А Х
  Предприятие : @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
  @~@@@@@@@@@@@@@@@@@@@@     @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@

.{ Vednar_JobSheetAdditionalPaymentLoop  checkenter
.}
.{ Vednar_JobListLoop  checkenter
.{ Vednar_JobListItemAdditionalPaymentLoop  checkenter
.}
.}
.{ Vednar_JobLoop checkenter
.[h OverWrite
─────┬─────────────────────┬──────────┬────────────────┬────────────┬─────┬──────┬────────┬─────────────┬─────────────
 N - │  Подразделение      │Табельный │  Фамилия И.О.  │   Тариф    │ КТУ │Кол-во│Кол-во  │  Оплата по  │ Премия
 п/п │                     │  номер   │                │  (оклад)   │     │ дней │часов   │   наряду    │
─────┼─────────────────────┼──────────┼────────────────┼────────────┼─────┼──────┼────────┼─────────────┼─────────────
.]h
.begin PersonalAccountCount := 0
  sum_KOLDN   := 0;
  sum_CHASF   := 0;
  sum_SUMMA   := 0;
  sum_SUMMPREM:= 0;
end.
.{ VedNar_PersonalAccountLoop checkenter
 &&&&│@@@@@@@@@@@@@@@@@@@@@│@@@@@@@@@@│@@@@@@@@@@@@@@@@│&'&&&&&&.&&&│&&.&&│&&&.&&│&'&&&.&&│&'&&&&&&&&.&&│&'&&&&&&&&.&&
.begin Inc(PersonalAccountCount)
  sum_KOLDN   := sum_KOLDN+ KOLDN;
  sum_CHASF   := sum_CHASF+ CHASF;
  sum_SUMMA   := sum_SUMMA+ SUMMA;
  sum_SUMMPREM:= sum_SUMMPREM+ SUMMPREM;
end.
.{ Vednar_JobAdditionalPaymentLoop checkenter
.}
.}
.{?internal;PersonalAccountCount > 1
 Б     │                     │          │                │            │ИТОГО│&&&.&&│&'&&&.&&│&'&&&&&&&&.&&│&'&&&&&&&&.&& Б
.}
.[f OverWrite
─────┴─────────────────────┴──────────┴────────────────┴────────────┴─────┴──────┴────────┴─────────────┴─────────────
.]f
.}
 Б                                      ИТОГО ПО НАРЯДУ                      &&&.&& &'&&&.&& &'&&&&&&&&.&& &'&&&&&&&&.&& С
.}
.}
.}
.endform

!-------------------------------------------------------------------------------
.linkform 'Vednar_03' prototype is 'vednar'
.NameInList  'Полная справка о бригадных нарядах '
.group 'Бригадные наряды'
.p 60
.var
  PersonalAccountCount: longint
  sum_KOLDN   : double;
  sum_CHASF   : double;
  sum_SUMMATR : double;
  sum_SUMMA   : double;
  sum_SUMMPREM: double;
  sum_AGRSUM  : double;
.endvar
.fields
 CommonFormHeader
 Npred dat1
 JobSheetName
!Лицевая сторона
 KodVidOplNar  NaimVidOplNar ProcDopNar SummaDopNar
 LshKodWork NmWork LshKodOper NmOper KolVoEdin LshRascen LshNormaTime
 StoimWork SummaTime
!доплаты
 KodVidOpl NaimVidOpl ProcDop SummaDop

 SummaStoimLsh SummamTimeLsh SummaDopLsh SummaDopLshN
 'true':'s'
!Строки
  if (PersonalAccountCount > 0, '', NP)
  if (PersonalAccountCount > 0, '', PersonalAccountDepartmentName)
  if (PersonalAccountCount > 0, '', TABN)
  if (PersonalAccountCount > 0, '', FIO)
  tarif KTY  Datan DatOk KOLDN CHASF
 SUMMATR SUMMA  SUMMPREM SUMMA + SUMMPREM

  sum_KOLDN
  sum_CHASF
  sum_SUMMATR
  sum_SUMMA
  sum_SUMMPREM
  sum_AGRSUM

 KOLDN:'sum:Vednar_PersonalAccountLoop' CHASF:'sum:Vednar_PersonalAccountLoop'
 SUMMATR:'sum:Vednar_PersonalAccountLoop' SUMMA:'sum:Vednar_PersonalAccountLoop' SUMMPREM:'sum:Vednar_PersonalAccountLoop' (SUMMA + SUMMPREM):'sum:Vednar_PersonalAccountLoop'
.endfields
^
.{ Vednar_DepartmentLoop checkenter
.{ VedNar_BrigadeLoop checkenter
.{ VedNar_JobSheetLoop checkenter

                          С П Р А В К А  О  Н А Р Я Д А Х
  Предприятие : @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
  @~@@@@@@@@@@@@@@@@@@@@  @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@

.{ Vednar_JobSheetAdditionalPaymentLoop  checkenter
.[h
         Доплаты на наряд
───────┬────────────────────────────────────┬───────┬─────────────
  Код  │     Наименование                   │Процент│   Сумма
 оплаты│      доплаты                       │       │
───────┼────────────────────────────────────┼───────┼─────────────
.]h

 &&&&  │@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@│&'&&.&&│&'&&&&&&&&.&&
.[f
───────┴────────────────────────────────────┴───────┴─────────────
.]f
.}

.{ Vednar_JobListLoop  checkenter
 Б
 &'&&&& @@@@@@@@@@@@@@@@@@@@@@@@@@@ &'&&&& @@@@@@@@@@@@@@@@@@@@@@ Б

Кол-во &'&&.&& На един. стоим. &'&&&&&&&&.&& время &'&&&&&&&&.&&
               Общая стоимость &'&&&&&&&&.&& время &'&&&&&&&&.&&
────────────────────────────────────────────────────────────────────

.{ Vednar_JobListItemAdditionalPaymentLoop  checkenter
.[h
───────┬────────────────────────────────────┬───────┬─────────────
  Код  │     Наименование                   │Процент│   Сумма
 оплаты│      доплаты                       │       │
───────┼────────────────────────────────────┼───────┼─────────────
.]h
 &&&&  │@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@│&'&&.&&│&'&&&&&&&&.&&
.[f
───────┴────────────────────────────────────┴───────┴─────────────
.]f
.}
.}
──────────────────────────────────────────────────────────────────
                 Общая информация по наряду
──────────────────────────────────────────────────────────────────
Суммарная стоимость &'&&&&&&&&.&&           время  &'&&&&&&&&.&&
Доплаты по работам  &'&&&&&&&&.&&   в целом наряд  &'&&&&&&&&.&&
──────────────────────────────────────────────────────────────────
! прогон листа
 ^
.{ VedNar_JobLoop checkenter
.[h OverWrite
 И─────┬───────────────────┬─────────┬───────────────────┬──────────────┬─────┬──────────┬──────────┬──────┬────────┬─────────────┬─────────────┬─────────────┬─────────────
 N - │  Подразделение    │Табельный│    Фамилия И.О.   │    Тариф     │ КТУ │   Дата   │   Дата   │Кол-во│Кол-во  │  Сумма по   │ Оплата по   │   Премия    │   Итого
 п/п │                   │  номер  │                   │   (оклад)    │     │  начала  │  заверш. │ дней │часов   │   тарифу    │   наряду    │             │
─────┼───────────────────┼─────────┼───────────────────┼──────────────┼─────┼──────────┼──────────┼──────┼────────┼─────────────┼─────────────┼─────────────┼─────────────
.]h
.begin PersonalAccountCount := 0
  sum_KOLDN   := 0;
  sum_CHASF   := 0;
  sum_SUMMATR := 0;
  sum_SUMMA   := 0;
  sum_SUMMPREM:= 0;
  sum_AGRSUM  := 0;
end.
.{ Vednar_PersonalAccountLoop checkenter
 &&&&│@@@@@@@@@@@@@@@@@@@│@@@@@@@@@│@@@@@@@@@@@@@@@@@@@│&'&&&&&&&&.&&&│&&.&&│@@@@@@@@@@│@@@@@@@@@@│&&&.&&│&'&&&.&&│&'&&&&&&&&.&&│&'&&&&&&&&.&&│&'&&&&&&&&.&&│&'&&&&&&&&.&&
.begin Inc(PersonalAccountCount)
  sum_KOLDN   := sum_KOLDN+ KOLDN;
  sum_CHASF   := sum_CHASF+ CHASF;
  sum_SUMMATR := sum_SUMMATR+ SUMMATR;
  sum_SUMMA   := sum_SUMMA+ SUMMA;
  sum_SUMMPREM:= sum_SUMMPREM+ SUMMPREM;
  sum_AGRSUM  := sum_AGRSUM+ SUMMA+ SUMMPREM;
end.
.{ Vednar_JobAdditionalPaymentLoop checkenter
.}
.}
.{?internal;PersonalAccountCount > 1
 Б     │                   │         │                   │              │     │          │     ИТОГО│&&&.&&│&'&&&.&&│&'&&&&&&&&.&&│&'&&&&&&&&.&&│&'&&&&&&&&.&&│&'&&&&&&&&.&& Б
.}
.[f OverWrite
─────┴───────────────────┴─────────┴───────────────────┴──────────────┴─────┴──────────┴──────────┴──────┴────────┴─────────────┴─────────────┴─────────────┴─────────────
.]f
.}
 Б                                      ИТОГО ПО НАРЯДУ                                              &&&.&& &'&&&.&& &'&&&&&&&&.&& &'&&&&&&&&.&& &'&&&&&&&&.&& &'&&&&&&&&.&& Й
.FIELDS
  'true':'s'
.ENDFIELDS
^
.}
.}
.}
.endform

!-------------------------------------------------------------------------------
.linkform 'Vednar_04' prototype is 'vednar'
.NameInList  'Справка об индивидуальных нарядах  '
.group 'Индивидуальные наряды'
.p 60
.var
  PersonalAccountCount: longint;
  sum_KOLDN   : double;
  sum_CHASF   : double;
  sum_SUMMA   : double;
  sum_SUMMPREM: double;

.endvar
.fields
 CommonFormHeader
 Npred dat1
 JobSheetName

  if (PersonalAccountCount > 0, '', NP)
  if (PersonalAccountCount > 0, '', PersonalAccountDepartmentName)
  if (PersonalAccountCount > 0, '', TABN)
  if (PersonalAccountCount > 0, '', FIO)
  KOLDN CHASF RASCEN  KolVo SUMMA  SUMMPREM

  sum_KOLDN
  sum_CHASF
  sum_SUMMA
  sum_SUMMPREM

 KOLDN:'sum:Vednar_PersonalAccountLoop' CHASF:'sum:Vednar_PersonalAccountLoop'
 SUMMA:'sum:Vednar_PersonalAccountLoop' SUMMPREM:'sum:Vednar_PersonalAccountLoop'
.endfields
 Р^
.{ VedNar_DepartmentLoop checkenter
.{ VedNar_BrigadeLoop checkenter
.{ Vednar_JobSheetLoop checkenter

                          С П Р А В К А  О  Н А Р Я Д А Х
  Предприятие : @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
  @~@@@@@@@@@@@@@@@@@@@@     @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
.{ Vednar_JobSheetAdditionalPaymentLoop  checkenter
.}
.{ Vednar_JobListLoop  checkenter
.{ Vednar_JobListItemAdditionalPaymentLoop  checkenter
.}
.}

.{ VedNar_JobLoop checkenter
.[h OverWrite
─────┬──────────────────────┬──────────┬─────────────────┬──────┬────────┬────────────┬───────┬─────────────┬─────────────
 N - │  Подразделение       │Табельный │   Фамилия И.О.  │Кол-во│Кол-во  │  Расценка  │Кол-во │  Оплата по  │ Премия
 п/п │                      │  номер   │                 │ дней │часов   │            │       │   наряду    │
─────┼──────────────────────┼──────────┼─────────────────┼──────┼────────┼────────────┼───────┼─────────────┼─────────────
.]h
.begin PersonalAccountCount := 0
  sum_KOLDN   := 0;
  sum_CHASF   := 0;
  sum_SUMMA   := 0;
  sum_SUMMPREM:= 0;
end.
.{ VedNar_PersonalAccountLoop checkenter
 &&&&│@@@@@@@@@@@@@@@@@@@@@@│@@@@@@@@@@│@@@@@@@@@@@@@@@@@│&&&.&&│&'&&&.&&│&'&&&&&&.&&&│&&&&.&&│&'&&&&&&&&.&&│&'&&&&&&&&.&&
.begin Inc(PersonalAccountCount)
  sum_KOLDN   := sum_KOLDN+ KOLDN;
  sum_CHASF   := sum_CHASF+ CHASF;
  sum_SUMMA   := sum_SUMMA+ SUMMA;
  sum_SUMMPREM:= sum_SUMMPREM+ SUMMPREM;
end.
.{ Vednar_JobAdditionalPaymentLoop checkenter
.}
.}
.{?internal;PersonalAccountCount > 1
 Б     │                      │          │            ИТОГО│&&&.&&│&'&&&.&&│            │       │&'&&&&&&&&.&&│&'&&&&&&&&.&& Б
.}
.[f OverWrite
─────┴──────────────────────┴──────────┴─────────────────┴──────┴────────┴────────────┴───────┴─────────────┴─────────────
.]f
.}
 Б                                        ИТОГО ПО НАРЯДУ  &&&&&&& &'&&&&&&                     &'&&&&&&&&&&&& &'&&&&&&&&&&& С
.}
.}
.}
.endform

//------------------------------------------------------------------------------
//------------------------------------------------------------------------------
//------------------------------------------------------------------------------
.linkform 'VedNar_02OZ' prototype is 'vednar'
.NameInList  'Справка о бригадных нарядах (ОЗ)'
.group 'Бригадные наряды'
.p 60
.var
  PersonalAccountCount: longint
  sum_KOLDN   : double;
  sum_CHASF   : double;
  sum_SUMMA   : double;
  sum_SUMMPREM: double;
.endvar
.fields
 CommonFormHeader
 Npred dat1
 JobSheetName

  if (PersonalAccountCount > 0, '', NP)
  CostsAssignmentDepartmentName
  if (PersonalAccountCount > 0, '', TABN)
  if (PersonalAccountCount > 0, '', FIO)
  tarif KTY  KOLDN CHASF SUMMA  SUMMPREM

  sum_KOLDN
  sum_CHASF
  sum_SUMMA
  sum_SUMMPREM

KOLDN:'sum:Vednar_PersonalAccountLoop' CHASF:'sum:Vednar_PersonalAccountLoop'
SUMMA:'sum:Vednar_PersonalAccountLoop' SUMMPREM:'sum:Vednar_PersonalAccountLoop'
.endfields
 Р^
.{ VedNar_DepartmentLoop checkenter
.{ VedNar_BrigadeLoop checkenter
.{ VedNar_JobSheetLoop checkenter

                          С П Р А В К А  О  Н А Р Я Д А Х
  Предприятие : @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
  @~@@@@@@@@@@@@@@@@@@@@     @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
.{ Vednar_JobSheetAdditionalPaymentLoop  checkenter
.}
.{ Vednar_JobListLoop  checkenter
.{ Vednar_JobListItemAdditionalPaymentLoop  checkenter
.}
.}

.{ VedNar_JobLoop checkenter
.[h OverWrite
─────┬─────────────────────┬──────────┬────────────────┬────────────┬─────┬──────┬────────┬─────────────┬─────────────
 N - │  Подразделение      │Табельный │  Фамилия И.О.  │   Тариф    │ КТУ │Кол-во│Кол-во  │  Оплата по  │ Премия
 п/п │ отнесения затрат    │  номер   │                │  (оклад)   │     │ дней │часов   │   наряду    │
─────┼─────────────────────┼──────────┼────────────────┼────────────┼─────┼──────┼────────┼─────────────┼─────────────
.]h
.begin PersonalAccountCount := 0
  sum_KOLDN   := 0;
  sum_CHASF   := 0;
  sum_SUMMA   := 0;
  sum_SUMMPREM:= 0;
end.
.{ VedNar_PersonalAccountLoop checkenter
 &&&&│@@@@@@@@@@@@@@@@@@@@@│@@@@@@@@@@│@@@@@@@@@@@@@@@@│&'&&&&&&.&&&│&&.&&│&&&.&&│&'&&&.&&│&'&&&&&&&&.&&│&'&&&&&&&&.&&
.begin Inc(PersonalAccountCount)
  sum_KOLDN   := sum_KOLDN+ KOLDN;
  sum_CHASF   := sum_CHASF+ CHASF;
  sum_SUMMA   := sum_SUMMA+ SUMMA;
  sum_SUMMPREM:= sum_SUMMPREM+ SUMMPREM;
end.
.{ Vednar_JobAdditionalPaymentLoop checkenter
.}
.}
.{?internal;PersonalAccountCount > 1
 Б     │                     │          │                │            │ИТОГО│&&&.&&│&'&&&.&&│&'&&&&&&&&.&&│&'&&&&&&&&.&& Б
.}
.[f OverWrite
─────┴─────────────────────┴──────────┴────────────────┴────────────┴─────┴──────┴────────┴─────────────┴─────────────
.]f
.}
 Б                                      ИТОГО ПО НАРЯДУ                      &&&.&& &'&&&.&& &'&&&&&&&&.&& &'&&&&&&&&.&& С
.}
.}
.}
.endform

//------------------------------------------------------------------------------
//------------------------------------------------------------------------------
//------------------------------------------------------------------------------
.linkform 'Vednar_03OZ' prototype is 'vednar'
.NameInList  'Полная справка о бригадных нарядах (ОЗ)'
.group 'Бригадные наряды'
.p 60
.var
  PersonalAccountCount: longint
  sum_KOLDN   : double;
  sum_CHASF   : double;
  sum_SUMMATR : double;
  sum_SUMMA   : double;
  sum_SUMMPREM: double;
  sum_AGRSUM  : double;

.endvar
.fields
 CommonFormHeader
 Npred dat1
 JobSheetName
!Лицевая сторона
 KodVidOplNar  NaimVidOplNar ProcDopNar SummaDopNar
 LshKodWork NmWork LshKodOper NmOper KolVoEdin LshRascen LshNormaTime
 StoimWork SummaTime
!доплаты
 KodVidOpl NaimVidOpl ProcDop SummaDop

 SummaStoimLsh SummamTimeLsh SummaDopLsh SummaDopLshN
 'true':'s'
!Строки
  if (PersonalAccountCount > 0, '', NP)
  CostsAssignmentDepartmentName
  if (PersonalAccountCount > 0, '', TABN)
  if (PersonalAccountCount > 0, '', FIO)
  tarif KTY  Datan DatOk KOLDN CHASF
 SUMMATR SUMMA  SUMMPREM SUMMA + SUMMPREM

  sum_KOLDN
  sum_CHASF
  sum_SUMMATR
  sum_SUMMA
  sum_SUMMPREM
  sum_AGRSUM
 KOLDN:'sum:Vednar_PersonalAccountLoop' CHASF:'sum:Vednar_PersonalAccountLoop'
 SUMMATR:'sum:Vednar_PersonalAccountLoop' SUMMA:'sum:Vednar_PersonalAccountLoop' SUMMPREM:'sum:Vednar_PersonalAccountLoop' (SUMMA + SUMMPREM):'sum:Vednar_PersonalAccountLoop'
.endfields
^
.{ VedNar_DepartmentLoop checkenter
.{ VedNar_BrigadeLoop checkenter
.{ VedNar_JobSheetLoop checkenter

                          С П Р А В К А  О  Н А Р Я Д А Х
  Предприятие : @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
  @~@@@@@@@@@@@@@@@@@@@@  @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@

.{ Vednar_JobSheetAdditionalPaymentLoop  checkenter
.[h
         Доплаты на наряд
───────┬────────────────────────────────────┬───────┬─────────────
  Код  │     Наименование                   │Процент│   Сумма
 оплаты│      доплаты                       │       │
───────┼────────────────────────────────────┼───────┼─────────────
.]h
 &&&&  │@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@│&'&&.&&│&'&&&&&&&&.&&
.[f
───────┴────────────────────────────────────┴───────┴─────────────
.]f
.}

.{ Vednar_JobListLoop  checkenter
 Б
 &'&&&& @@@@@@@@@@@@@@@@@@@@@@@@@@@ &'&&&& @@@@@@@@@@@@@@@@@@@@@@ Б

Кол-во &'&&.&& На един. стоим. &'&&&&&&&&.&& время &'&&&&&&&&.&&
               Общая стоимость &'&&&&&&&&.&& время &'&&&&&&&&.&&
────────────────────────────────────────────────────────────────────

.{ Vednar_JobListItemAdditionalPaymentLoop  checkenter
.[h
───────┬────────────────────────────────────┬───────┬─────────────
  Код  │     Наименование                   │Процент│   Сумма
 оплаты│      доплаты                       │       │
───────┼────────────────────────────────────┼───────┼─────────────

.]h
 &&&&  │@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@│&'&&.&&│&'&&&&&&&&.&&
.[f
───────┴────────────────────────────────────┴───────┴─────────────
.]f
.}
.}

──────────────────────────────────────────────────────────────────
                 Общая информация по наряду
──────────────────────────────────────────────────────────────────
Суммарная стоимость &'&&&&&&&&.&&           время  &'&&&&&&&&.&&
Доплаты по работам  &'&&&&&&&&.&&   в целом наряд  &'&&&&&&&&.&&
──────────────────────────────────────────────────────────────────
! прогон листа
 ^
.{ VedNar_JobLoop checkenter
.[h OverWrite
 И─────┬───────────────────┬─────────┬───────────────────┬──────────────┬─────┬──────────┬──────────┬──────┬────────┬─────────────┬─────────────┬─────────────┬─────────────
 N - │  Подразделение    │Табельный│    Фамилия И.О.   │    Тариф     │ КТУ │   Дата   │   Дата   │Кол-во│Кол-во  │  Сумма по   │ Оплата по   │   Премия    │  Итого
 п/п │ отнесения затрат  │  номер  │                   │   (оклад)    │     │  начала  │  заверш. │ дней │часов   │   тарифу    │   наряду    │             │
─────┼───────────────────┼─────────┼───────────────────┼──────────────┼─────┼──────────┼──────────┼──────┼────────┼─────────────┼─────────────┼─────────────┼─────────────
.]h
.begin PersonalAccountCount := 0
  sum_KOLDN   := 0;
  sum_CHASF   := 0;
  sum_SUMMATR := 0;
  sum_SUMMA   := 0;
  sum_SUMMPREM:= 0;
  sum_AGRSUM  := 0;
end.
.{ VedNar_PersonalAccountLoop checkenter
 &&&&│@@@@@@@@@@@@@@@@@@@│@@@@@@@@@│@@@@@@@@@@@@@@@@@@@│&'&&&&&&&&.&&&│&&.&&│@@@@@@@@@@│@@@@@@@@@@│&&&.&&│&'&&&.&&│&'&&&&&&&&.&&│&'&&&&&&&&.&&│&'&&&&&&&&.&&│&'&&&&&&&&.&&
.begin Inc(PersonalAccountCount)
  sum_KOLDN   := sum_KOLDN+ KOLDN;
  sum_CHASF   := sum_CHASF+ CHASF;
  sum_SUMMATR := sum_SUMMATR+ SUMMATR;
  sum_SUMMA   := sum_SUMMA+ SUMMA;
  sum_SUMMPREM:= sum_SUMMPREM+ SUMMPREM;
  sum_AGRSUM  := sum_AGRSUM+ SUMMA+ SUMMPREM;
end.
.{ Vednar_JobAdditionalPaymentLoop checkenter
.}
.}
.{?internal;PersonalAccountCount > 1
 Б     │                   │         │                   │              │     │          │     ИТОГО│&&&.&&│&'&&&.&&│&'&&&&&&&&.&&│&'&&&&&&&&.&&│&'&&&&&&&&.&&│&'&&&&&&&&.&& Б
.}
.[f OverWrite
─────┴───────────────────┴─────────┴───────────────────┴──────────────┴─────┴──────────┴──────────┴──────┴────────┴─────────────┴─────────────┴─────────────┴─────────────
.]f
.}
 Б                                      ИТОГО ПО НАРЯДУ                                              &&&.&& &'&&&.&& &'&&&&&&&&.&& &'&&&&&&&&.&& &'&&&&&&&&.&& &'&&&&&&&&.&& Й
.FIELDS
  'true':'s'
.ENDFIELDS
^
.}
.}
.}
.endform

!-------------------------------------------------------------------------------
.linkform 'Vednar_04' prototype is 'vednar'
.NameInList  'Справка об индивидуальных нарядах  '
.group 'Индивидуальные наряды'
.p 60
.var
  PersonalAccountCount: longint
  sum_KOLDN   : double;
  sum_CHASF   : double;
  sum_SUMMA   : double;
  sum_SUMMPREM: double;

.endvar
.fields
 CommonFormHeader
 Npred dat1
 JobSheetName

  if (PersonalAccountCount > 0, '', NP)
  if (PersonalAccountCount > 0, '', PersonalAccountDepartmentName)
  if (PersonalAccountCount > 0, '', TABN)
  if (PersonalAccountCount > 0, '', FIO)
  KOLDN CHASF RASCEN  KolVo SUMMA  SUMMPREM

  sum_KOLDN
  sum_CHASF
  sum_SUMMA
  sum_SUMMPREM

 KOLDN:'sum:Vednar_PersonalAccountLoop' CHASF:'sum:Vednar_PersonalAccountLoop'
 SUMMA:'sum:Vednar_PersonalAccountLoop' SUMMPREM:'sum:Vednar_PersonalAccountLoop'
.endfields
 Р^
.{ VedNar_DepartmentLoop checkenter
.{ VedNar_BrigadeLoop checkenter
.{ VedNar_JobSheetLoop checkenter

                          С П Р А В К А  О  Н А Р Я Д А Х
  Предприятие : @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
  @~@@@@@@@@@@@@@@@@@@@@     @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
.{ Vednar_JobSheetAdditionalPaymentLoop  checkenter
.}
.{ Vednar_JobListLoop  checkenter
.{ Vednar_JobListItemAdditionalPaymentLoop  checkenter
.}
.}

.{ VedNar_JobLoop checkenter
.[h OverWrite
─────┬──────────────────────┬──────────┬─────────────────┬──────┬────────┬────────────┬───────┬─────────────┬─────────────
 N - │  Подразделение       │Табельный │   Фамилия И.О.  │Кол-во│Кол-во  │  Расценка  │Кол-во │  Оплата по  │ Премия
 п/п │                      │  номер   │                 │ дней │часов   │            │       │   наряду    │
─────┼──────────────────────┼──────────┼─────────────────┼──────┼────────┼────────────┼───────┼─────────────┼─────────────
.]h
.begin PersonalAccountCount := 0
  sum_KOLDN   := 0;
  sum_CHASF   := 0;
  sum_SUMMA   := 0;
  sum_SUMMPREM:= 0;
end.
.{ VedNar_PersonalAccountLoop checkenter
 &&&&│@@@@@@@@@@@@@@@@@@@@@@│@@@@@@@@@@│@@@@@@@@@@@@@@@@@│&&&.&&│&'&&&.&&│&'&&&&&&.&&&│&&&&.&&│&'&&&&&&&&.&&│&'&&&&&&&&.&&
.begin Inc(PersonalAccountCount)
  sum_KOLDN   := sum_KOLDN+ KOLDN;
  sum_CHASF   := sum_CHASF+ CHASF;
  sum_SUMMA   := sum_SUMMA+ SUMMA;
  sum_SUMMPREM:= sum_SUMMPREM+ SUMMPREM;
end.
.{ Vednar_JobAdditionalPaymentLoop checkenter
.}
.}
.{?internal;PersonalAccountCount > 1
 Б     │                      │          │            ИТОГО│&&&.&&│&'&&&.&&│            │       │&'&&&&&&&&.&&│&'&&&&&&&&.&& Б
.}
.[f OverWrite
─────┴──────────────────────┴──────────┴─────────────────┴──────┴────────┴────────────┴───────┴─────────────┴─────────────
.]f
.}
 Б                                        ИТОГО ПО НАРЯДУ  &&&&&&& &'&&&&&&                     &'&&&&&&&&&&&& &'&&&&&&&&&&& С
.}
.}
.}
.endform
//------------------------------------------------------------------------------
//------------------------------------------------------------------------------
//------------------------------------------------------------------------------

!-------------------------------------------------------------------------------
.linkform 'VedNar_05' prototype is 'vednar'
.NameInList  'Полная cправка об индивидуальных нарядах  '
.group 'Индивидуальные наряды'
.p 60
.var
  PersonalAccountCount: longint
  sum_KOLDN   : double;
  sum_CHASF   : double;
  sum_SUMMA   : double;
  sum_SUMMPREM: double;
  sum_AGRSUM  : double;

.endvar
.fields
 CommonFormHeader
 Npred dat1
 JobSheetName
  if (PersonalAccountCount > 0, '', NP)
  if (PersonalAccountCount > 0, '', PersonalAccountDepartmentName)
  if (PersonalAccountCount > 0, '', TABN)
  if (PersonalAccountCount > 0, '', FIO)
  Datan DatOk KOLDN CHASF KODWork NOPER RASCEN  KolVo SUMMA  SUMMPREM SUMMA + SUMMPREM

  sum_KOLDN
  sum_CHASF
  sum_SUMMA
  sum_SUMMPREM
  sum_AGRSUM

KOLDN:'sum:Vednar_PersonalAccountLoop' CHASF:'sum:Vednar_PersonalAccountLoop'
SUMMA:'sum:Vednar_PersonalAccountLoop' SUMMPREM:'sum:Vednar_PersonalAccountLoop' (SUMMA + SUMMPREM):'sum:Vednar_PersonalAccountLoop'
.endfields
 И^
.{ VedNar_DepartmentLoop checkenter
.{ VedNar_BrigadeLoop checkenter
.{ VedNar_JobSheetLoop checkenter

                          С П Р А В К А  О  Н А Р Я Д А Х
  Предприятие : @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
  @~@@@@@@@@@@@@@@@@@@@@     @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
.{ Vednar_JobSheetAdditionalPaymentLoop  checkenter
.}
.{ Vednar_JobListLoop  checkenter
.{ Vednar_JobListItemAdditionalPaymentLoop  checkenter
.}
.}

.{ VedNar_JobLoop checkenter
.[h OverWrite
─────┬────────────────────┬──────────┬─────────────────┬──────────┬──────────┬──────┬────────┬───────┬───────┬────────────┬───────┬─────────────┬─────────────┬─────────────
 N - │  Подразделение     │Табельный │  Фамилия И.О.   │   Дата   │   Дата   │Кол-во│Кол-во  │ Код   │ Код   │  Расценка  │Кол-во │  Оплата по  │   Премия    │  Итого
 п/п │                    │  номер   │                 │  начала  │  заверш. │ дней │часов   │работы │операц.│            │       │   наряду    │             │
─────┼────────────────────┼──────────┼─────────────────┼──────────┼──────────┼──────┼────────┼───────┼───────┼────────────┼───────┼─────────────┼─────────────┼─────────────
.]h
.begin PersonalAccountCount := 0
  sum_KOLDN   := 0;
  sum_CHASF   := 0;
  sum_SUMMA   := 0;
  sum_SUMMPREM:= 0;
  sum_AGRSUM  := 0;
end.
.{ VedNar_PersonalAccountLoop checkenter
 &&&&│@@@@@@@@@@@@@@@@@@@@│@@@@@@@@@@│@@@@@@@@@@@@@@@@@│@@@@@@@@@@│@@@@@@@@@@│&&&.&&│&'&&&.&&│&&&&&&&│&&&&&&&│&'&&&&&&.&&&│&&&&.&&│&'&&&&&&&&.&&│&'&&&&&&&&.&&│&'&&&&&&&&.&&
.begin Inc(PersonalAccountCount)
  sum_KOLDN   := sum_KOLDN+ KOLDN;
  sum_CHASF   := sum_CHASF+ CHASF;
  sum_SUMMA   := sum_SUMMA+ SUMMA;
  sum_SUMMPREM:= sum_SUMMPREM+ SUMMPREM;
  sum_AGRSUM  := sum_AGRSUM+ SUMMA+ SUMMPREM+ NARDOPSUM;
end.
.{ Vednar_JobAdditionalPaymentLoop checkenter
.}
.}
.{?internal;PersonalAccountCount > 1
 Б     │                    │          │                 │          │     ИТОГО│&&&.&&│&'&&&.&&│       │       │            │       │&'&&&&&&&&.&&│&'&&&&&&&&.&&│&'&&&&&&&&.&& Б
.}
.[f OverWrite
─────┴────────────────────┴──────────┴─────────────────┴──────────┴──────────┴──────┴────────┴───────┴───────┴────────────┴───────┴─────────────┴─────────────┴─────────────
.]f
.}
 Б                                      ИТОГО ПО НАРЯДУ                         &&&&&& &'&&&&&&                                      &'&&&&&&&&.&& &'&&&&&&&&.&& &'&&&&&&&&.&& Й
.}
.}
.}
.endform

!-------------------------------------------------------------------------------
.linkform 'Vednar_06' prototype is 'vednar'
.NameInList  'Справка об индивидуальных нарядах c учетом КТУ  '
.group 'Индивидуальные наряды c КТУ'
.var
  PersonalAccountCount: longint
  sum_KOLDN   : double;
  sum_CHASF   : double;
  sum_SUMMA   : double;
  sum_SUMMPREM: double;

.endvar
.p 60
.fields
 CommonFormHeader
 Npred dat1
 JobSheetName
  if (PersonalAccountCount > 0, '', NP)
  if (PersonalAccountCount > 0, '', PersonalAccountDepartmentName)
  if (PersonalAccountCount > 0, '', TABN)
  if (PersonalAccountCount > 0, '', FIO)
  KTY KOLDN CHASF RASCEN  KolVo SUMMA  SUMMPREM

  sum_KOLDN
  sum_CHASF
  sum_SUMMA
  sum_SUMMPREM
  KOLDN:'sum:Vednar_PersonalAccountLoop' CHASF:'sum:Vednar_PersonalAccountLoop'
  SUMMA:'sum:Vednar_PersonalAccountLoop' SUMMPREM:'sum:Vednar_PersonalAccountLoop'
.endfields
 Р^
.{ VedNar_DepartmentLoop checkenter
.{ VedNar_BrigadeLoop checkenter
.{ VedNar_JobSheetLoop checkenter

                          С П Р А В К А  О  Н А Р Я Д А Х
  Предприятие : @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
  @~@@@@@@@@@@@@@@@@@@@@     @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
.{ Vednar_JobSheetAdditionalPaymentLoop  checkenter
.}
.{ Vednar_JobListLoop  checkenter
.{ Vednar_JobListItemAdditionalPaymentLoop  checkenter
.}
.}

.{ VedNar_JobLoop checkenter
.[h OverWrite
─────┬───────────────────┬──────────┬──────────────────┬──────┬────────┬────────┬────────────┬───────┬─────────────┬─────────────
 N - │  Подразделение    │Табельный │    Фамилия И.О.  │ КТУ  │Кол-во  │Кол-во  │  Расценка  │Кол-во │  Оплата по  │ Премия
 п/п │                   │  номер   │                  │      │дней    │часов   │            │       │   наряду    │
─────┼───────────────────┼──────────┼──────────────────┼──────┼────────┼────────┼────────────┼───────┼─────────────┼─────────────
.]h
.begin PersonalAccountCount := 0
  sum_KOLDN   := 0;
  sum_CHASF   := 0;
  sum_SUMMA   := 0;
  sum_SUMMPREM:= 0;
end.
.{ VedNar_PersonalAccountLoop checkenter
 &&&&│@@@@@@@@@@@@@@@@@@@│@@@@@@@@@@│@@@@@@@@@@@@@@@@@@│&&&.&&│&'&&&.&&│&'&&&.&&│&'&&&&&&.&&&│&&&&.&&│&'&&&&&&&&.&&│&'&&&&&&&&.&&
.begin Inc(PersonalAccountCount)
  sum_KOLDN   := sum_KOLDN+ KOLDN;
  sum_CHASF   := sum_CHASF+ CHASF;
  sum_SUMMA   := sum_SUMMA+ SUMMA;
  sum_SUMMPREM:= sum_SUMMPREM+ SUMMPREM;
end.
.{ Vednar_JobAdditionalPaymentLoop checkenter
.}
.}
.{?internal;PersonalAccountCount > 1
 Б     │                   │          │                  │ ИТОГО│&'&&&.&&│&'&&&.&&│            │       │&'&&&&&&&&.&&│&'&&&&&&&&.&& Б
.}
.[f OverWrite
─────┴───────────────────┴──────────┴──────────────────┴──────┴────────┴────────┴────────────┴───────┴─────────────┴─────────────
.]f
.}
 Б                                      ИТОГО ПО НАРЯДУ          &'&&&.&& &'&&&.&&                      &'&&&&&&&&.&& &'&&&&&&&&.&& С
.}
.}
.}
.endform

!-------------------------------------------------------------------------------
.linkform 'Vednar_07' prototype is 'vednar'
.NameInList  'Полная cправка об индивидуальных нарядах с учетом КТУ '
.group 'Индивидуальные наряды c КТУ'
.p 60
.var
  PersonalAccountCount: longint
  sum_KOLDN   : double;
  sum_CHASF   : double;
  sum_SUMMA   : double;
  sum_SUMMPREM: double;
  sum_AGRSUM  : double;
.endvar
.fields
 CommonFormHeader
 Npred dat1
 JobSheetName
  if (PersonalAccountCount > 0, '', NP)
  if (PersonalAccountCount > 0, '', PersonalAccountDepartmentName)
  if (PersonalAccountCount > 0, '', TABN)
  if (PersonalAccountCount > 0, '', FIO)
  KTY Datan Datok KOLDN CHASF
KODWork NOPER RASCEN  KolVo SUMMA  SUMMPREM SUMMA + SUMMPREM

  sum_KOLDN
  sum_CHASF
  sum_SUMMA
  sum_SUMMPREM
  sum_AGRSUM
KOLDN:'sum:Vednar_PersonalAccountLoop' CHASF:'sum:Vednar_PersonalAccountLoop'
SUMMA:'sum:Vednar_PersonalAccountLoop' SUMMPREM:'sum:Vednar_PersonalAccountLoop' (SUMMA + SUMMPREM):'sum:Vednar_PersonalAccountLoop'
.endfields
 И^
.{ VedNar_DepartmentLoop checkenter
.{ VedNar_BrigadeLoop checkenter
.{ VedNar_JobSheetLoop checkenter

                          С П Р А В К А  О  Н А Р Я Д А Х
  Предприятие : @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
  @~@@@@@@@@@@@@@@@@@@@@     @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
.{ Vednar_JobSheetAdditionalPaymentLoop  checkenter
.}
.{ Vednar_JobListLoop  checkenter
.{ Vednar_JobListItemAdditionalPaymentLoop  checkenter
.}
.}

.{ VedNar_JobLoop checkenter
.[h OverWrite
─────┬──────────────────┬──────────┬───────────────────┬──────┬──────────┬──────────┬──────┬────────┬───────┬───────┬────────────┬───────┬─────────────┬─────────────┬─────────────
 N - │  Подразделение   │Табельный │    Фамилия И.О.   │ КТУ  │   Дата   │   Дата   │Кол-во│Кол-во  │ Код   │ Код   │  Расценка  │Кол-во │  Оплата по  │   Премия    │  Итого
 п/п │                  │  номер   │                   │      │  начала  │  заверш. │ дней │часов   │работы │операц.│            │       │   наряду    │             │
─────┼──────────────────┼──────────┼───────────────────┼──────┼──────────┼──────────┼──────┼────────┼───────┼───────┼────────────┼───────┼─────────────┼─────────────┼─────────────
.]h
.begin PersonalAccountCount := 0
  sum_KOLDN   := 0;
  sum_CHASF   := 0;
  sum_SUMMA   := 0;
  sum_SUMMPREM:= 0;
  sum_AGRSUM  := 0;
end.
.{ VedNar_PersonalAccountLoop checkenter
 &&&&│@@@@@@@@@@@@@@@@@@│@@@@@@@@@@│@@@@@@@@@@@@@@@@@@@│&&&.&&│@@@@@@@@@@│@@@@@@@@@@│&&&.&&│&'&&&.&&│&&&&&&&│&&&&&&&│&'&&&&&&.&&&│&&&&.&&│&'&&&&&&&&.&&│&'&&&&&&&&.&&│&'&&&&&&&&.&&
.begin Inc(PersonalAccountCount)
  sum_KOLDN   := sum_KOLDN+ KOLDN;
  sum_CHASF   := sum_CHASF+ CHASF;
  sum_SUMMA   := sum_SUMMA+ SUMMA;
  sum_SUMMPREM:= sum_SUMMPREM+ SUMMPREM;
  sum_AGRSUM  := sum_AGRSUM+ SUMMA+ SUMMPREM+ NARDOPSUM;
end.
.{ Vednar_JobAdditionalPaymentLoop checkenter
.}
.}
.{?internal;PersonalAccountCount > 1
 Б     │                  │          │                   │      │          │     ИТОГО│&&&.&&│&'&&&.&&│       │       │            │       │&'&&&&&&&&.&&│&'&&&&&&&&.&&│&'&&&&&&&&.&& Б
.}
.[f OverWrite
─────┴──────────────────┴──────────┴───────────────────┴──────┴──────────┴──────────┴──────┴────────┴───────┴───────┴────────────┴───────┴─────────────┴─────────────┴─────────────
.]f
.}
 Б                                      ИТОГО ПО НАРЯДУ                                &&&.&& &'&&&.&&                                      &'&&&&&&&&.&& &'&&&&&&&&.&& &'&&&&&&&&.&& Й
.}
.}
.}
.endform

//------------------------------------------------------------------------------
//------------------------------------------------------------------------------
//------------------------------------------------------------------------------
.linkform 'VedNar_02KAU' prototype is 'vednar'
.NameInList  'Справка о бригадных нарядах (счет-субсчет-КАУ)'
.group 'Бригадные наряды'
.p 60
.var
  PersonalAccountCount: longint
  sum_KOLDN   : double;
  sum_CHASF   : double;
  sum_SUMMA   : double;
  sum_SUMMPREM: double;
.endvar
.fields
 CommonFormHeader
 Npred dat1
 JobSheetName

  if (PersonalAccountCount > 0, '', NP)
  CostsAssignmentDepartmentName SchetDeb SubSchdeb NamKAUD
  if (PersonalAccountCount > 0, '', TABN)
  if (PersonalAccountCount > 0, '', FIO) tarif KTY  KOLDN CHASF SUMMA  SUMMPREM

  sum_KOLDN
  sum_CHASF
  sum_SUMMA
  sum_SUMMPREM

KOLDN:'sum:Vednar_PersonalAccountLoop' CHASF:'sum:Vednar_PersonalAccountLoop'
SUMMA:'sum:Vednar_PersonalAccountLoop' SUMMPREM:'sum:Vednar_PersonalAccountLoop'
.endfields
 Р^
.{ VedNar_DepartmentLoop checkenter
.{ VedNar_BrigadeLoop checkenter
.{ VedNar_JobSheetLoop checkenter

                          С П Р А В К А  О  Н А Р Я Д А Х
  Предприятие : @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
  @~@@@@@@@@@@@@@@@@@@@@     @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
.{ Vednar_JobSheetAdditionalPaymentLoop  checkenter
.}
.{ Vednar_JobListLoop  checkenter
.{ Vednar_JobListItemAdditionalPaymentLoop  checkenter
.}
.}

.{ VedNar_JobLoop checkenter
.[h OverWrite
─────┬─────────────────────┬────┬────┬─────────────────────────────┬──────────┬────────────────┬────────────┬─────┬──────┬────────┬─────────────┬─────────────
 N - │  Подразделение      │Счет│Суб │  КАУ                        │Табельный │  Фамилия И.О.  │   Тариф    │ КТУ │Кол-во│Кол-во  │  Оплата по  │ Премия
 п/п │ отнесения затрат    │    │счет│                             │  номер   │                │  (оклад)   │     │ дней │часов   │   наряду    │
─────┼─────────────────────┼────┼────┼─────────────────────────────┼──────────┼────────────────┼────────────┼─────┼──────┼────────┼─────────────┼─────────────
.]h
.begin PersonalAccountCount := 0
  sum_KOLDN   := 0;
  sum_CHASF   := 0;
  sum_SUMMA   := 0;
  sum_SUMMPREM:= 0;
end.
.{ VedNar_PersonalAccountLoop checkenter
 &&&&│@@@@@@@@@@@@@@@@@@@@@│@@@@│@@@@│@@@@@@@@@@@@@@@@@@@@@@@@@@@@@│@@@@@@@@@@│@@@@@@@@@@@@@@@@│&'&&&&&&.&&&│&&.&&│&&&.&&│&'&&&.&&│&'&&&&&&&&.&&│&'&&&&&&&&.&&
.begin Inc(PersonalAccountCount)
  sum_KOLDN   := sum_KOLDN+ KOLDN;
  sum_CHASF   := sum_CHASF+ CHASF;
  sum_SUMMA   := sum_SUMMA+ SUMMA;
  sum_SUMMPREM:= sum_SUMMPREM+ SUMMPREM;
end.
.{ Vednar_JobAdditionalPaymentLoop checkenter
.}
.}
.{?internal;PersonalAccountCount > 1
 Б     │                     │    │    │                             │          │                │            │ИТОГО│&&&.&&│&'&&&.&&│&'&&&&&&&&.&&│&'&&&&&&&&.&& Б
.}
.[f OverWrite
─────┴─────────────────────┴────┴────┴─────────────────────────────┴──────────┴────────────────┴────────────┴─────┴──────┴────────┴─────────────┴─────────────
.]f
.}
 Б                                                                              ИТОГО ПО НАРЯДУ                      &&&.&& &'&&&.&& &'&&&&&&&&.&& &'&&&&&&&&.&& С
.}
.}
.}
.endform

//------------------------------------------------------------------------------
//------------------------------------------------------------------------------
//------------------------------------------------------------------------------
.linkform 'Vednar_03KAU' prototype is 'vednar'
.NameInList  'Полная справка о бригадных нарядах (счет-субсчет-КАУ)'
.group 'Бригадные наряды'
.p 60
.var
  PersonalAccountCount: longint
  sum_KOLDN   : double;
  sum_CHASF   : double;
  sum_SUMMATR : double;
  sum_SUMMA   : double;
  sum_SUMMPREM: double;
  sum_AGRSUM  : double;
.endvar
.fields
 CommonFormHeader
 Npred dat1
 JobSheetName
!Лицевая сторона
 KodVidOplNar  NaimVidOplNar ProcDopNar SummaDopNar SchetDebDopNar SubSchdebDopNar NamKAUDDopNar
 LshKodWork NmWork LshKodOper NmOper KolVoEdin LshRascen LshNormaTime
 StoimWork SummaTime
!доплаты
 KodVidOpl NaimVidOpl ProcDop SummaDop SchetDebDop SubSchdebDop NamKAUDDop

 SummaStoimLsh SummamTimeLsh SummaDopLsh SummaDopLshN
 'true':'s'
!Строки
  if (PersonalAccountCount > 0, '', NP)
  CostsAssignmentDepartmentName SchetDeb SubSchdeb NamKAUD
  if (PersonalAccountCount > 0, '', TABN)
  if (PersonalAccountCount > 0, '', FIO)
  tarif KTY  Datan DatOk KOLDN CHASF
 SUMMATR SUMMA  SUMMPREM SUMMA + SUMMPREM

  sum_KOLDN
  sum_CHASF
  sum_SUMMATR
  sum_SUMMA
  sum_SUMMPREM
  sum_AGRSUM
 KOLDN:'sum:Vednar_PersonalAccountLoop' CHASF:'sum:Vednar_PersonalAccountLoop'
 SUMMATR:'sum:Vednar_PersonalAccountLoop' SUMMA:'sum:Vednar_PersonalAccountLoop' SUMMPREM:'sum:Vednar_PersonalAccountLoop' (SUMMA + SUMMPREM):'sum:Vednar_PersonalAccountLoop'
.endfields
^
.{ VedNar_DepartmentLoop checkenter
.{ VedNar_BrigadeLoop checkenter
.{ VedNar_JobSheetLoop checkenter

                          С П Р А В К А  О  Н А Р Я Д А Х
  Предприятие : @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
  @~@@@@@@@@@@@@@@@@@@@@  @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@

.{ Vednar_JobSheetAdditionalPaymentLoop  checkenter
.[h
         Доплаты на наряд
───────┬────────────────────────────────────┬───────┬─────────────┬────┬────┬─────────────────────────────
  Код  │     Наименование                   │Процент│   Сумма     │Счет│Суб │  КАУ
 оплаты│      доплаты                       │       │             │    │счет│
───────┼────────────────────────────────────┼───────┼─────────────┼────┼────┼─────────────────────────────
.]h
 &&&&  │@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@│&'&&.&&│&'&&&&&&&&.&&│@@@@│@@@@│@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
.[f
───────┴────────────────────────────────────┴───────┴─────────────┴────┴────┴─────────────────────────────
.]f
.}

.{ Vednar_JobListLoop  checkenter
 Б
 &'&&&& @@@@@@@@@@@@@@@@@@@@@@@@@@@ &'&&&& @@@@@@@@@@@@@@@@@@@@@@ Б

Кол-во &'&&.&& На един. стоим. &'&&&&&&&&.&& время &'&&&&&&&&.&&
               Общая стоимость &'&&&&&&&&.&& время &'&&&&&&&&.&&
──────────────────────────────────────────────────────────────────────────────────────────────────────────

.{ Vednar_JobListItemAdditionalPaymentLoop  checkenter
.[h
         Доплаты на работу (операцию)
───────┬────────────────────────────────────┬───────┬─────────────┬────┬────┬─────────────────────────────
  Код  │     Наименование                   │Процент│   Сумма     │Счет│Суб │  КАУ
 оплаты│      доплаты                       │       │             │    │счет│
───────┼────────────────────────────────────┼───────┼─────────────┼────┼────┼─────────────────────────────
.]h
 &&&&  │@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@│&'&&.&&│&'&&&&&&&&.&&│&&&&│&&&&│@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
.[f
───────┴────────────────────────────────────┴───────┴─────────────┴────┴────┴─────────────────────────────
.]f
.}
.}
──────────────────────────────────────────────────────────────────────────────────────────────────────────
                 Общая информация по наряду
──────────────────────────────────────────────────────────────────────────────────────────────────────────
Суммарная стоимость &'&&&&&&&&.&&           время  &'&&&&&&&&.&&
Доплаты по работам  &'&&&&&&&&.&&   в целом наряд  &'&&&&&&&&.&&
──────────────────────────────────────────────────────────────────────────────────────────────────────────
! прогон листа
 ^
.{ VedNar_JobLoop checkenter
.[h OverWrite
 И─────┬───────────────────┬────┬────┬─────────────────────────────┬─────────┬───────────────────┬──────────────┬─────┬──────────┬──────────┬──────┬────────┬─────────────┬─────────────┬─────────────┬─────────────
 N - │  Подразделение    │Счет│Суб │  КАУ                        │Табельный│    Фамилия И.О.   │    Тариф     │ КТУ │   Дата   │   Дата   │Кол-во│Кол-во  │  Сумма по   │ Оплата по   │   Премия    │  Итого
 п/п │ отнесения затрат  │    │счет│                             │  номер  │                   │   (оклад)    │     │  начала  │  заверш. │ дней │часов   │   тарифу    │   наряду    │             │
─────┼───────────────────┼────┼────┼─────────────────────────────┼─────────┼───────────────────┼──────────────┼─────┼──────────┼──────────┼──────┼────────┼─────────────┼─────────────┼─────────────┼─────────────
.]h
.begin PersonalAccountCount := 0
  sum_KOLDN   := 0;
  sum_CHASF   := 0;
  sum_SUMMATR := 0;
  sum_SUMMA   := 0;
  sum_SUMMPREM:= 0;
  sum_AGRSUM  := 0;
end.
.{ VedNar_PersonalAccountLoop checkenter
 &&&&│@@@@@@@@@@@@@@@@@@@│@@@@│@@@@│@@@@@@@@@@@@@@@@@@@@@@@@@@@@@│@@@@@@@@@│@@@@@@@@@@@@@@@@@@@│&'&&&&&&&&.&&&│&&.&&│@@@@@@@@@@│@@@@@@@@@@│&&&.&&│&'&&&.&&│&'&&&&&&&&.&&│&'&&&&&&&&.&&│&'&&&&&&&&.&&│&'&&&&&&&&.&&
.begin Inc(PersonalAccountCount)
  sum_KOLDN   := sum_KOLDN+ KOLDN;
  sum_CHASF   := sum_CHASF+ CHASF;
  sum_SUMMATR := sum_SUMMATR+ SUMMATR;
  sum_SUMMA   := sum_SUMMA+ SUMMA;
  sum_SUMMPREM:= sum_SUMMPREM+ SUMMPREM;
  sum_AGRSUM  := sum_AGRSUM+ SUMMA+ SUMMPREM;
end.
.{ Vednar_JobAdditionalPaymentLoop checkenter
.}
.}
.{?internal;PersonalAccountCount > 1
 Б     │                   │    │    │                             │         │                   │              │     │          │     ИТОГО│&&&.&&│&'&&&.&&│&'&&&&&&&&.&&│&'&&&&&&&&.&&│&'&&&&&&&&.&&│&'&&&&&&&&.&& Б
.}
.[f OverWrite
─────┴───────────────────┴────┴────┴─────────────────────────────┴─────────┴───────────────────┴──────────────┴─────┴──────────┴──────────┴──────┴────────┴─────────────┴─────────────┴─────────────┴─────────────
.]f
.}
 Б                                      ИТОГО ПО НАРЯДУ                                                                                      &&&.&& &'&&&.&& &'&&&&&&&&.&& &'&&&&&&&&.&& &'&&&&&&&&.&& &'&&&&&&&&.&& Й
.FIELDS
  'true':'s'
.ENDFIELDS
^
.}
.}
.}
.endform

!-------------------------------------------------------------------------------
.linkform 'Vednar_03_dopl' prototype is 'vednar'
.NameInList  'Полная справка о бригадных нарядах с доплатами'
.group 'Бригадные наряды'
.p 60
.var
  APCount:              longint;
  PersonalAccountCount: longint;
  sum_KOLDN:            double;
  sum_CHASF:            double;
  sum_SUMMATR:          double;
  sum_SUMMA:            double;
  sum_SUMMPREM:         double;
  sum_NARDOPSUM:        double;
  // полный заработок = сделка + премия + доплаты
  WorkerEarnings:       double;
  total_NARDOPSUM:      double;
  total_SUMMA:          double;
  total_SUMMPREM:       double;
  sum_AGRSUM:           double;

.endvar
.fields
 CommonFormHeader
 Npred dat1
 JobSheetName
!Лицевая сторона
 KodVidOplNar  NaimVidOplNar ProcDopNar SummaDopNar
 LshKodWork NmWork LshKodOper NmOper KolVoEdin LshRascen LshNormaTime
 StoimWork SummaTime
!доплаты
 KodVidOpl NaimVidOpl ProcDop SummaDop

 SummaStoimLsh SummamTimeLsh SummaDopLsh SummaDopLshN
 'true':'s'
!Строки
  if (PersonalAccountCount > 0, '', NP)
  if (PersonalAccountCount > 0, '', PersonalAccountDepartmentName)
  if (PersonalAccountCount > 0, '', TABN)
  if (PersonalAccountCount > 0, '', FIO)
  tarif KTY  Datan DatOk KOLDN CHASF
  SUMMATR SUMMA  SUMMPREM SUMMA + SUMMPREM

  NarDopName NarDopSum
  NarDopSum:'sum:Vednar_JobAdditionalPaymentLoop'
  WorkerEarnings

  sum_KOLDN
  sum_CHASF
  sum_SUMMATR
  sum_SUMMA
  sum_SUMMPREM
  sum_NARDOPSUM
  sum_AGRSUM+ sum_NARDOPSUM


  KOLDN:'sum:Vednar_PersonalAccountLoop'
  CHASF:'sum:Vednar_PersonalAccountLoop'
  SUMMATR:'sum:Vednar_PersonalAccountLoop'
  SUMMA:'sum:Vednar_PersonalAccountLoop'
  SUMMPREM:'sum:Vednar_PersonalAccountLoop'
  total_NARDOPSUM
  total_SUMMA + total_SUMMPREM + total_NARDOPSUM
.endfields
^
.{ VedNar_DepartmentLoop checkenter
.{ VedNar_BrigadeLoop checkenter
.{ VedNar_JobSheetLoop checkenter
.begin total_NARDOPSUM:= 0; total_SUMMA:= 0; total_SUMMPREM:= 0; end.
                          С П Р А В К А  О  Н А Р Я Д А Х
  Предприятие : @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
  @~@@@@@@@@@@@@@@@@@@@@  @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@

.{ Vednar_JobSheetAdditionalPaymentLoop  checkenter
.[h
         Доплаты на наряд
───────┬────────────────────────────────────┬───────┬─────────────
  Код  │     Наименование                   │Процент│   Сумма
 оплаты│      доплаты                       │       │
───────┼────────────────────────────────────┼───────┼─────────────
.]h
 &&&&  │@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@│&'&&.&&│&'&&&&&&&&.&&
.[f
───────┴────────────────────────────────────┴───────┴─────────────
.]f
.}

.{ Vednar_JobListLoop  checkenter
 Б
 &'&&&& @@@@@@@@@@@@@@@@@@@@@@@@@@@ &'&&&& @@@@@@@@@@@@@@@@@@@@@@ Б

Кол-во &'&&.&& На един. стоим. &'&&&&&&&&.&& время &'&&&&&&&&.&&
               Общая стоимость &'&&&&&&&&.&& время &'&&&&&&&&.&&
────────────────────────────────────────────────────────────────────

.{ Vednar_JobListItemAdditionalPaymentLoop  checkenter
.[h
───────┬────────────────────────────────────┬───────┬─────────────
  Код  │     Наименование                   │Процент│   Сумма
 оплаты│      доплаты                       │       │
───────┼────────────────────────────────────┼───────┼─────────────
.]h
 &&&&  │@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@│&'&&.&&│&'&&&&&&&&.&&
.[f
───────┴────────────────────────────────────┴───────┴─────────────
.]f
.}
.}
──────────────────────────────────────────────────────────────────
                 Общая информация по наряду
──────────────────────────────────────────────────────────────────
Суммарная стоимость &'&&&&&&&&.&&           время  &'&&&&&&&&.&&
Доплаты по работам  &'&&&&&&&&.&&   в целом наряд  &'&&&&&&&&.&&
──────────────────────────────────────────────────────────────────
 ^
.{ VedNar_JobLoop checkenter
.[h OverWrite
 Й─────┬───────────────────┬─────────┬───────────────────┬──────────────┬─────┬──────────┬──────────┬──────┬────────┬─────────────┬─────────────┬─────────────┬──────────────────────────────┬─────────────┬─────────────
 N - │  Подразделение    │Табельный│    Фамилия И.О.   │    Тариф     │ КТУ │   Дата   │   Дата   │Кол-во│Кол-во  │  Сумма по   │ Оплата по   │   Премия    │     Наименование доплаты     │    Сумма    │  Итого
 п/п │                   │  номер  │                   │   (оклад)    │     │  начала  │  заверш. │ дней │часов   │   тарифу    │   наряду    │             │                              │  доплаты    │
─────┼───────────────────┼─────────┼───────────────────┼──────────────┼─────┼──────────┼──────────┼──────┼────────┼─────────────┼─────────────┼─────────────┼──────────────────────────────┼─────────────┼───────────── Й
.]h
.begin PersonalAccountCount := 0
  sum_KOLDN   := 0;
  sum_CHASF   := 0;
  sum_SUMMATR := 0;
  sum_SUMMA   := 0;
  sum_SUMMPREM:= 0;
  sum_NARDOPSUM:= 0;
  sum_AGRSUM  := 0;
end.
.{ VedNar_PersonalAccountLoop checkenter
 И &&&&│@@@@@@@@@@@@@@@@@@@│@@@@@@@@@│@@@@@@@@@@@@@@@@@@@│&'&&&&&&&&.&&&│&&.&&│@@@@@@@@@@│@@@@@@@@@@│&&&.&&│&'&&&.&&│&'&&&&&&&&.&&│&'&&&&&&&&.&&│&'&&&&&&&&.&&│                              │             │&'&&&&&&&&.&& И
.begin
  Inc(PersonalAccountCount);
  APCount := 0 ;
  sum_KOLDN   := sum_KOLDN+ KOLDN;
  sum_CHASF   := sum_CHASF+ CHASF;
  sum_SUMMATR := sum_SUMMATR+ SUMMATR;
  sum_SUMMA   := sum_SUMMA+ SUMMA;
  sum_SUMMPREM:= sum_SUMMPREM+ SUMMPREM;
  sum_AGRSUM  := sum_AGRSUM+ SUMMA+ SUMMPREM;
  total_SUMMA := total_SUMMA+ SUMMA;
  total_SUMMPREM:= total_SUMMPREM+ SUMMPREM;

  WorkerEarnings := SUMMA + SUMMPREM;
end.
.{ Vednar_JobAdditionalPaymentLoop checkenter
.begin
  Inc(APCount);
  WorkerEarnings := WorkerEarnings + NARDOPSUM;
  sum_NARDOPSUM:= sum_NARDOPSUM+ NARDOPSUM;
  total_NARDOPSUM:= total_NARDOPSUM+ NARDOPSUM;
end.
 И     │                   │         │                   │              │     │          │          │      │        │             │             │             │@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@│&'&&&&&&&&.&&│ И
.}
.{?internal;(APCount > 0);
 И     │                   │         │                   │              │     │          │          │      │        │             │             │             │ БИТОГО по доплатам             │&'&&&&&&&&.&&│&'&&&&&&&&.&& Й
.}
.}
.{?internal;PersonalAccountCount > 1
 И     │                   │         │                   │              │     │          │      БИТОГО│&&&.&&│&'&&&.&&│&'&&&&&&&&.&&│&'&&&&&&&&.&&│&'&&&&&&&&.&&│                              │&'&&&&&&&&.&&│&'&&&&&&&&.&& Й
.}
.[f OverWrite
 И─────┴───────────────────┴─────────┴───────────────────┴──────────────┴─────┴──────────┴──────────┴──────┴────────┴─────────────┴─────────────┴─────────────┴──────────────────────────────┴─────────────┴───────────── И
.]f
.}
 И                                         БИТОГО ПО НАРЯДУ                                          &'&&&.&& &'&&&.&& &'&&&&&&&&.&& &'&&&&&&&&.&& &'&&&&&&&&.&&                                &'&&&&&&&&.&& &'&&&&&&&&.&& Й
.FIELDS
  'true':'s'
.ENDFIELDS
^
.}
.}
.}
.endform

//------------------------------------------------------------------------------
//------------------------------------------------------------------------------
.linkform 'Vednar_03_fulldopl' prototype is 'vednar'
.NameInList  'Полная справка о бригадных нарядах с доплатами и часами по ним'
.group 'Бригадные наряды'
.p 60
.var
  APCount: longint
  PersonalAccountCount: longint
  sum_KOLDN:        double;
  sum_CHASF:        double;
  sum_SUMMATR:      double;
  sum_SUMMA:        double;
  sum_SUMMPREM:     double;
  sum_NARDOPSUM:    double;
  sum_AGRSUM:       double;
  // полный заработок = сделка + премия + доплаты
  WorkerEarnings:   double;
  total_SUMMA:      double;
  total_SUMMPREM:   double;
  total_NARDOPSUM:  double;
.endvar
.fields
  CommonFormHeader
  Npred dat1
  JobSheetName
!Лицевая сторона
  KodVidOplNar  NaimVidOplNar ProcDopNar SummaDopNar
  LshKodWork NmWork LshKodOper NmOper KolVoEdin LshRascen LshNormaTime
  StoimWork SummaTime
!доплаты
  KodVidOpl NaimVidOpl ProcDop SummaDop

  SummaStoimLsh SummamTimeLsh SummaDopLsh SummaDopLshN
  'true':'s'
!Строки
  if (PersonalAccountCount > 0, '', NP)
  if (PersonalAccountCount > 0, '', PersonalAccountDepartmentName)
  if (PersonalAccountCount > 0, '', TABN)
  if (PersonalAccountCount > 0, '', FIO)
  tarif KTY  Datan DatOk KOLDN CHASF
  SUMMATR SUMMA  SUMMPREM SUMMA + SUMMPREM

  string(NarDopVidOpl) + ', ' +  NarDopName
  NarDopHours NarDopDays NarDopSum
  NarDopHours:'SUM'
  NarDopDays:'sum'
  NarDopSum:'sum:Vednar_JobAdditionalPaymentLoop'
  WorkerEarnings

  sum_KOLDN
  sum_CHASF
  sum_SUMMATR
  sum_SUMMA
  sum_SUMMPREM
  sum_NARDOPSUM
  sum_AGRSUM+ sum_NARDOPSUM


  KOLDN:'sum:Vednar_PersonalAccountLoop'
  CHASF:'sum:Vednar_PersonalAccountLoop'
  SUMMATR:'sum:Vednar_PersonalAccountLoop'
  SUMMA:'sum:Vednar_PersonalAccountLoop'
  SUMMPREM:'sum:Vednar_PersonalAccountLoop'
  TOTAL_NarDopSum
  TOTAL_SUMMA + TOTAL_SUMMPREM + TOTAL_NarDopSum
.endfields
 И^
.{ VedNar_DepartmentLoop checkenter
.{ VedNar_BrigadeLoop checkenter
.{ VedNar_JobSheetLoop checkenter
.begin total_SUMMA:= 0; total_SUMMPREM:= 0; total_NARDOPSUM:= 0; end.

                           БС П Р А В К А  О  Н А Р Я Д А Х Б

Предприятие:          Б@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Б

@@@@@@@@@@@@@@@@@@@   Б@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ Б
 И
 И.{ Vednar_JobSheetAdditionalPaymentLoop  checkenter И
.[h
 ЙДоплаты на наряд Б
───────┬────────────────────────────────────┬───────┬─────────────
  Код  │     Наименование                   │Процент│   Сумма
 оплаты│      доплаты                       │       │
───────┼────────────────────────────────────┼───────┼─────────────
.]h
 &&&&  │@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@│&'&&.&&│&'&&&&&&&&.&&
.[f
 И───────┴────────────────────────────────────┴───────┴───────────── И
.]f
 И.}

.{ Vednar_JobListLoop  checkenter
 И &'&&&& @@@@@@@@@@@@@@@@@@@@@@@@@@@ &'&&&& @@@@@@@@@@@@@@@@@@@@@@@

Кол-во &'&&.&& На един. стоим. &'&&&&&&&&.&& время &'&&&&&&&&.&&
               Общая стоимость &'&&&&&&&&.&& время &'&&&&&&&&.&&
────────────────────────────────────────────────────────────────── И

.{ Vednar_JobListItemAdditionalPaymentLoop  checkenter
.[h
 И───────┬────────────────────────────────────┬───────┬─────────────
  Код  │     Наименование                   │Процент│   Сумма
 оплаты│      доплаты                       │       │
───────┼────────────────────────────────────┼───────┼───────────── И
.]h
 И &&&&  │@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@│&'&&.&&│&'&&&&&&&&.&& И
.[f
 И───────┴────────────────────────────────────┴───────┴───────────── И
.]f
.}
.}
 И──────────────────────────────────────────────────────────────────
                  БОбщая информация по наряду Б
──────────────────────────────────────────────────────────────────
Суммарная стоимость &'&&&&&&&&.&&           время  &'&&&&&&&&.&&
Доплаты по работам  &'&&&&&&&&.&&   в целом наряд  &'&&&&&&&&.&&
──────────────────────────────────────────────────────────────────
 ^ И
.{ VedNar_JobLoop checkenter
.[h OverWrite
 Й─────┬───────────────────┬──────────┬───────────────────┬──────────────┬─────┬──────────┬──────────┬──────┬────────┬─────────────┬─────────────┬─────────────┬──────────────────────────────┬─────────┬─────────┬─────────────┬─────────────
 N   │Подразделение      │ Табельный│    Фамилия И.О.   │         Тариф│  КТУ│Дата      │Дата      │Кол-во│  Кол-во│     Сумма по│    Оплата по│       Премия│Наименование доплаты          │  Часы по│   Дни по│        Сумма│        Итого
 п/п │                   │     номер│                   │       (оклад)│     │начала    │окончания │  дней│   часов│       тарифу│       наряду│             │                              │  доплате│  доплате│      доплаты│
─────┼───────────────────┼──────────┼───────────────────┼──────────────┼─────┼──────────┼──────────┼──────┼────────┼─────────────┼─────────────┼─────────────┼──────────────────────────────┼─────────┼─────────┼─────────────┼───────────── Й
.]h
.begin PersonalAccountCount := 0
  sum_KOLDN   := 0;
  sum_CHASF   := 0;
  sum_SUMMATR := 0;
  sum_SUMMA   := 0;
  sum_SUMMPREM:= 0;
  sum_NARDOPSUM:= 0;
  sum_AGRSUM  := 0;
end.
.{ VedNar_PersonalAccountLoop checkenter
 И &&&&│@@@@@@@@@@@@@@@@@@@│&&&&&&&&&&│@@@@@@@@@@@@@@@@@@@│&'&&&&&&&&.&&&│&&.&&│@@@@@@@@@@│@@@@@@@@@@│&&&.&&│&'&&&.&&│&'&&&&&&&&.&&│&'&&&&&&&&.&&│&'&&&&&&&&.&&│                              │         │         │             │&'&&&&&&&&.&& И
.begin
  Inc(PersonalAccountCount);
  APCount := 0;
  sum_KOLDN   := sum_KOLDN+ KOLDN;
  sum_CHASF   := sum_CHASF+ CHASF;
  sum_SUMMATR := sum_SUMMATR+ SUMMATR;
  sum_SUMMA   := sum_SUMMA+ SUMMA;
  sum_SUMMPREM:= sum_SUMMPREM+ SUMMPREM;
  sum_AGRSUM  := sum_AGRSUM+ SUMMA+ SUMMPREM;
  total_SUMMA := total_SUMMA+ SUMMA;
  total_SUMMPREM:= total_SUMMPREM+ SUMMPREM;

  WorkerEarnings := SUMMA + SUMMPREM;
end.
.{ Vednar_JobAdditionalPaymentLoop checkenter
.begin
  Inc(APCount);
  WorkerEarnings := WorkerEarnings + NARDOPSUM;
  sum_NARDOPSUM:= sum_NARDOPSUM+ NARDOPSUM;
  total_NARDOPSUM:= total_NARDOPSUM+ NARDOPSUM;
end.
 И     │                   │          │                   │              │     │          │          │      │        │             │             │             │@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@│&'&&&&.&&│&'&&&&&.&│&'&&&&&&&&.&&│ И
.}
.{?internal;(APCount > 0);
 Й     │                   │          │                   │              │     │          │          │      │        │             │             │             │             Итого по доплатам│&'&&&&.&&│&'&&&&&.&│&'&&&&&&&&.&&│&'&&&&&&&&.&& Й
.}
.}
.{?internal;PersonalAccountCount > 1
 Н     │                   │          │                   │              │     │          │     ИТОГО│&&&.&&│&'&&&.&&│&'&&&&&&&&.&&│&'&&&&&&&&.&&│&'&&&&&&&&.&&│                              │         │         │&'&&&&&&&&.&&│&'&&&&&&&&.&& Н
.}
.}

 Й                                         ИТОГО ПО НАРЯДУ                                          &'&&&.&& &'&&&.&& &'&&&&&&&&.&& &'&&&&&&&&.&& &'&&&&&&&&.&&                                                    &'&&&&&&&&.&& &'&&&&&&&&.&& Й
.FIELDS
  'true':'s'
.ENDFIELDS
^
.}
.}
.}
.endform

//------------------------------------------------------------------------------
.linkform VedNar_140 prototype is VedNar
.group 'Общие отчеты'
.nameinlist 'Работы по нарядам отдельно от бригад'
.p 60
.var
  JobHours: double;
  JobSheetHours: double;
  BrigadeHours: double;
  DepartmentHours: double;
.endvar
.fields
  CommonFormHeader

  DepartmentName
  BrigadeName

  JobSheetName

  TABN
  FIO
  Time2Str(JobHours, 2)
  SUMMA:'sum:VedNar_PersonalAccountLoop'
  SUMMPREM:'sum:VedNar_PersonalAccountLoop'
  NarDopSum:'sum:VedNar_JobAdditionalPaymentLoop'

  'Всего по наряду: ' + JobSheetName
  Time2Str(JobSheetHours, 2)
  SUMMA:'sum:VedNar_PersonalAccountLoop'
  SUMMPREM:'sum:VedNar_PersonalAccountLoop'
  NarDopSum:'sum:VedNar_JobAdditionalPaymentLoop'

  'Всего по бригаде: ' + BrigadeName
  Time2Str(BrigadeHours, 2)
  SUMMA:'sum:VedNar_PersonalAccountLoop'
  SUMMPREM:'sum:VedNar_PersonalAccountLoop'
  NarDopSum:'sum:VedNar_JobAdditionalPaymentLoop'

  'Всего' + if (DepartmentName <> '', ' по подразделению: ' + DepartmentName, ' по нарядам без привязки к подразделению')
  Time2Str(DepartmentHours, 2)
  SUMMA:'sum:VedNar_PersonalAccountLoop'
  SUMMPREM:'sum:VedNar_PersonalAccountLoop'
  NarDopSum:'sum:VedNar_JobAdditionalPaymentLoop'
.endfields
 И^
                           БРасчет зарплаты по работам, выполненным
                              по нарядам отдельно от бригад Й
.{ VedNar_DepartmentLoop checkenter
.begin DepartmentHours := 0 end.

.{?internal;DepartmentName <> ''
 ИПодразделение: Б ^ Й
.}
.{ VedNar_BrigadeLoop checkenter
.begin BrigadeHours := 0 end.
.{?internal;BrigadeName <> ''

 Й   ББригада: Б ^ Й
.}
.{ VedNar_JobSheetLoop checkenter
.begin JobSheetHours := 0 end.

 Й     БНаряд: Б ^ Й
.{ VedNar_JobSheetAdditionalPaymentLoop checkenter
.}
.{ VedNar_JobListLoop  checkenter
.{ VedNar_JobListItemAdditionalPaymentLoop  checkenter
.}
.}
.{ VedNar_JobLoop checkenter
.[h
 Й         Таб.№ Фамилия, И.О.                        Время  Сумма зар.      Премия     Доплаты
    ---------- ----------------------------- ------------ ----------- ----------- ----------- Й
.]h
.begin JobHours := 0 end.
.{ VedNar_PersonalAccountLoop checkenter
.begin JobHours := JobHours + CHASF end.
.{ VedNar_JobAdditionalPaymentLoop checkenter
.}
.}
 И    &&&&&&&&&& @@@@@@@@@@@@@@@@@@@@@@@@@@@@@ &&&&&&&&&&&& &'&&&&&&.&& &'&&&&&&.&& &'&&&&&&.&& И
.begin JobSheetHours := JobSheetHours + JobHours end.
.[f
 Й    ---------- ----------------------------- ------------ ----------- ----------- ----------- Й
.]f
.}
.begin BrigadeHours := BrigadeHours + JobSheetHours end.
 Й    @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ &&&&&&&&&&&& &'&&&&&&.&& &'&&&&&&.&& &'&&&&&&.&& Й
.}
.begin DepartmentHours := DepartmentHours + BrigadeHours end.
.{?internal;BrigadeName <> ''
 Й  @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ &&&&&&&&&&&& &'&&&&&&.&& &'&&&&&&.&& &'&&&&&&.&& Й
.}
.}

 Й@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ &&&&&&&&&&&& &'&&&&&&.&& &'&&&&&&.&& &'&&&&&&.&& Й
.}


 ИИсполнил:                                                  Бухгалтер: И
.endform
