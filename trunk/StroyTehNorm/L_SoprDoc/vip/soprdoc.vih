#ifndef __SoprDoc_vih__
#define __SoprDoc_vih__

#ifdef ComponentVersion
#component "L_SoprDoc"
#end

//******************************************************************************
#doc
  обработка накладных на отпуск
#end
//******************************************************************************

ObjInterface SoprDocObj;

//------------------------------------------------------------------------------
#doc
Назначение:
  Связать с накладной акты на услуги
Параметры:
  pNakl     - ссылка на сопроводительный документ
  WithCheck - проверка на наличие актов
#end
//------------------------------------------------------------------------------

Function AktSopUslForm(pNakl : comp; WithCheck : boolean) : boolean;

//------------------------------------------------------------------------------
#doc
Назначение:
  Формирование расходного ордера
Параметры:
  cSopr_    - ссылка на сопроводительный документ
  needMsg_  - выдача сообщений
  pDateOrd_ - дата ордера
#end
//------------------------------------------------------------------------------

Function MakeRashOrderByKatSopr(cSopr_: comp; needMsg_: boolean; pDateOrd_: date): boolean;

end;

//******************************************************************************
#doc
  обработка накладных на отпуск
#end
//******************************************************************************

ObjInterface SoprDocObj1;

//------------------------------------------------------------------------------
#doc
Назначение:
  Пересчет сумм в документах, указанных в маркере RecalcKatSopr
Параметры:
  нет
#end
//------------------------------------------------------------------------------

Procedure RecalcSoprDoc;

//------------------------------------------------------------------------------
#doc
Назначение:
  пересчет сумм в соповодительно документе
Параметры:
  cSopr_    - ссылка на сопроводительный документ
  full_     - true - полный пересчет
#end
//------------------------------------------------------------------------------

Procedure CheckSumma2(cSopr_: comp; full_:boolean);//lf_
end;

//******************************************************************************
#doc
  обработка накладных на отпуск
#end
//******************************************************************************

ObjInterface SoprDocObj2;

//------------------------------------------------------------------------------
#doc
Назначение:
  переформирование складского ордера
Параметры:
  Nrec_KatSopr   - ссылка на сопроводительный документ
  Nrec_SklOrder  - ссылка на складской ордер
#end
//------------------------------------------------------------------------------

Function MakeOrder2(Nrec_KatSopr:comp;Nrec_SklOrder:comp):boolean;

end;

//******************************************************************************
#doc
  обработка накладных на отпуск
#end
//******************************************************************************

ObjInterface SoprDocObj3;

//------------------------------------------------------------------------------
#doc
Назначение:
  функция для пересчета налога при формировании накладной по ДО
Параметры:
  wSopr - вид сопроводительного документа
#end
//------------------------------------------------------------------------------

Procedure _SetTypeSopr(wSopr: word);

//------------------------------------------------------------------------------
#doc
Назначение:
  обработка после вставки позиции в сор.документ
Параметры:
  pKatSopr - ссылка на сопроводительный документ
  pSpSopr  - ссылка на позицию сопр.документа
#end
//------------------------------------------------------------------------------

Procedure _OnAfterInsertSpSopr(pKatSopr:comp; pSpSopr:comp);

//------------------------------------------------------------------------------
#doc
Назначение:
  пересчет сумм в сопроводительном документе
Параметры:
  pKatSopr - ссылка на сопроводительный документ
  _par     - _par = 1 - установка средних цен
#end
//------------------------------------------------------------------------------

Function _RecalcSummaKatSopr(pKatSopr:comp;_par:word):boolean;

end;

//******************************************************************************
#doc
  обработка накладных на отпуск
#end
//******************************************************************************

ObjInterface SoprDocObj4;

//------------------------------------------------------------------------------
#doc
Назначение:
  проверка на перед удалением сопр.документа
Параметры:
  pNRec - ссылка на этап ДО
#end
//------------------------------------------------------------------------------

Function CanDeleteSoprDocumentOnBaseDoc(pNRec: comp):boolean;

//------------------------------------------------------------------------------
#doc
Назначение:
  удаление сопр.документа
Параметры:
  pNRec - ссылка на этап ДО
#end
//------------------------------------------------------------------------------

Function DeleteSoprDocument(pNrec:comp):boolean;

//------------------------------------------------------------------------------
#doc
Назначение:
  установка позиции в сопр.документе
Параметры:
  KS - ссылка на сопр.документ
#end
//------------------------------------------------------------------------------

Procedure _SetPosition(KS: comp);

//------------------------------------------------------------------------------
#doc
Назначение:
  удаление сопр.документа (устаревшее)
Параметры:
  нет
#end
//------------------------------------------------------------------------------

Procedure _DeletePosition;
end;

#ifdef __SKYSHOP__
//******************************************************************************
#doc
  обработка накладных на отпуск (__SKYSHOP__)
  в данный момент не используется
#end
//******************************************************************************

ObjInterface SoprDocObjSky;
  function MakeRashOrd(NeedMsg: boolean; pDateOrd: longint): boolean;
  procedure CheckSumma(full:boolean);
  procedure _UnDockPosition;
  procedure _DockPosition;
  procedure _SetPosition(KS: comp);
  function _GetPosition: comp;
  procedure _DeletePosition;
  procedure SetStateSpecOk(KS: comp);
  procedure SelectSkyButton;
  procedure InitSkyShopEditWindow;
end;
#end

//удаление сопроводительного документа
#include delsopr.vih

#ifdef _SOPRDOC_VIP
  VipInterface SoprDoc_Release implements SoprDocObj,
                                          SoprDocObj1,
                                          SoprDocObj2,
                                          SoprDocObj3,
                                          SoprDocObj4,
                                          objBeforeDelSopr
                                        #ifdef __SKYSHOP__
                                         ,SoprDocObjSky
                                        #end
    licensed
    (
!    #include SoprDoc.lih
    Free
    )
    Parameters (TypeSopr: word; pNRec: comp);
    public:
      Function MakeAveragePrice: boolean;
      Function PickByTune (wPick: word): boolean;
    end;
#else
  VipInterface SoprDoc implements SoprDocObj,
                                  SoprDocObj1,
                                  SoprDocObj2,
                                  SoprDocObj3,
                                  SoprDocObj4,
                                  objBeforeDelSopr
                               #ifdef __SKYSHOP__
                                 ,SoprDocObjSky
                                #end
    licensed
    (
!    #include SoprDoc.lih
    Free
    )
    Parameters (TypeSopr: word; pNRec: comp);
#end
//******************************************************************************
#doc
  точка расширения для обработки события cmValue7
#end
//******************************************************************************

ExtensionPoint epRunDopMenuSoprDoc (NrecKatSopr : comp);

#end // __SoprDoc_vih__
