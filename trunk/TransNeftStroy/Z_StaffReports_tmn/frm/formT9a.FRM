//-----------------------------------------------------------------------------------
//                                                           (c) корпорация Галактика
// Галактика 5.80 - Приказы на командировки
// Приказ о направлении работников в командировку Т-9а (групповой, max на 3 человека)
//-----------------------------------------------------------------------------------

#doc
Приказ о направлении работников в командировку Т-9а (групповой, max на 3 
человека).
#end
.set name='formT9a'
.hide
.fields
 НаимОрг
 ОКПО

 НомерДок
 ДатаДок

 ДолжностьРук
 ФИОРук

 ФИО1
 ФИО1_VP
 ТабНомер1
 СтруктПодр1
 Профессия1
 СтранаГород1
 ОрганизКоманд1
 ДатаНачала1
 ДатаОкончания1
 Срок1
 Цель1
 ЗаСчетСредств1

 ФИО2
 ФИО2_VP
 ТабНомер2
 СтруктПодр2
 Профессия2
 СтранаГород2
 ОрганизКоманд2
 ДатаНачала2
 ДатаОкончания2
 Срок2
 Цель2
 ЗаСчетСредств2

 ФИО3
 ФИО3_VP
 ТабНомер3
 СтруктПодр3
 Профессия3
 СтранаГород3
 ОрганизКоманд3
 ДатаНачала3
 ДатаОкончания3
 Срок3
 Цель3
 ЗаСчетСредств3
 Основание
 МемоПримечание
.endfields
.{ CheckEnter ListRep
 НаимОрг ^
 ОКПО ^

 НомерДок ^
 ДатаДок ^

 ДолжностьРук ^
 ФИОРук ^

 ФИО1 ^
 ФИО1_VP ^
 ТабНомер1 ^
 СтруктПодр1 ^
 Профессия1 ^
 СтранаГород1 ^
 ОрганизКоманд1 ^
 ДатаНачала1 ^
 ДатаОкончания1 ^
 Срок1 ^
 Цель1 ^
 ЗаСчетСредств1 ^

 ФИО2 ^
 ФИО2_VP ^
 ТабНомер2 ^
 СтруктПодр2 ^
 Профессия2 ^
 СтранаГород2 ^
 ОрганизКоманд2 ^
 ДатаНачала2 ^
 ДатаОкончания2 ^
 Срок2 ^
 Цель2 ^
 ЗаСчетСредств2 ^

 ФИО3 ^
 ФИО3_VP ^
 ТабНомер3 ^
 СтруктПодр3 ^
 Профессия3 ^
 СтранаГород3 ^
 ОрганизКоманд3 ^
 ДатаНачала3 ^
 ДатаОкончания3 ^
 Срок3 ^
 Цель3 ^
 ЗаСчетСредств3 ^

 Основание ^
 МемоПримечание ^
.{ CheckEnter NextPage
.}
.}
.endform

.linkform 'formT9a02' prototype is 'formT9a'
.nameinlist 'Приказ о направлении работников в командировку (Т-9а)'
.defo portrait
.var
 Основание1 : string
.endvar
.fields
 ОКПО
 НаимОрг
 НомерДок
 ДатаДок
 ФИО1              ФИО2               ФИО3
 ТабНомер1         ТабНомер2          ТабНомер3
 СтруктПодр1       СтруктПодр2        СтруктПодр3
 Профессия1        Профессия2         Профессия3
 if(ФИО1='','',СтранаГород1)  if(ФИО2='','',СтранаГород2)  if(ФИО3='','',СтранаГород3)
 if(ФИО1='','',ОрганизКоманд1)  if(ФИО2='','',ОрганизКоманд2)  if(ФИО3='','',ОрганизКоманд3)
 ДатаНачала1       ДатаНачала2        ДатаНачала3
 ДатаОкончания1    ДатаОкончания2     ДатаОкончания3
 Срок1             Срок2              Срок3
 Цель1             Цель2              Цель3
 GroupWrap(ЗаСчетСредств1,1,28)
 GroupWrap(ЗаСчетСредств2,1,28)
 GroupWrap(ЗаСчетСредств3,1,28)
 GroupWrapStr(ЗаСчетСредств1,2,28)
 GroupWrapStr(ЗаСчетСредств2,2,28)
 GroupWrapStr(ЗаСчетСредств3,2,28)
 Основание1
  Trim(SubStr(Основание,length(Основание1)+1,length(Основание)-length(Основание1)))
 МемоПримечание
 ДолжностьРук
 ФИОРук
 'true' : 's'
.endfields
.begin
Основание1 :=  GroupWrap(Основание,1,54);
end.
.{ CheckEnter ListRep
#include formT9a.frl
.{ CheckEnter NextPage
  ^
.}
.}
.endform